A dc amplifier having a single-pole response with pole frequency 10Hz and unity-gain frequency of 1MHz is operated in a loop whose frequency-independent feedback factor is 0.01. Find the low-frequency gain, the 3-dB frequency, and the unity-gain frequency of the closed-loop amplifier. By what factor does the pole shift?
\begin{enumerate}[label=\arabic*.,ref=\theenumi]
\numberwithin{equation}{enumi}

\item Find $G(s)$.
\\
\solution The open-loop gain of the amplifier can be expressed as
\begin{align}
    G\brak{s}=\frac{G_{0}}{1+\frac{s}{\omega_p}}=\frac{G_{0}}{1+\frac{s}{2\pi 10}}
\end{align}
%
Let $f_0 = 1$ MHz.
%Given that unity gain frequency is 1MHz\\
%Replacing $s$ with $\j\omega$ in this equation.
\begin{align}
\because  \abs{G\brak{\j \omega_0}} &=1,
\\
% \abs{\frac{G_{0}}{1+\frac{\j.2\pi.10^6}{2\pi.10}}}&=1\\
\implies       \abs{G_{0}}&=\abs{1+\j\frac{2\pi.10^6}{2\pi.10}}\\
\text{or, }    G_{0}&\approx10^5
\end{align}
Thus, 
\begin{align}
    G\brak{s}=\frac{10^5}{1+\frac{s}{2\pi 10}}
\label{eq:ee18btech11035_G}
\end{align}

%\item Draw the bode plots of open-loop circuit\\
%\solution
%\begin{figure}[!h]
%  \includegraphics[width=\columnwidth]{./figs/ee18btech11035_bode1.eps}
%  \caption{Bode plots of Open-loop Transfer Function}
%  \label{fig:ee18btech11035_bode1}
%\end{figure}
%
%Python code for above plot is
%\begin{lstlisting}
%codes/ee18btech11035_bode1.py
%\end{lstlisting}

%\item Design a Circuit for G\brak{s}\\
%\solution Designing G\brak{s} Using Op-amp with DC gain of $10^5$ and a pole at 10Hz.
%
%\begin{figure}[!ht]
%    \begin{center}
%		\resizebox{0.95\columnwidth}{!}{\input{./figs/ee18btech11035_G.tex}}
%	\end{center}
%\caption{}
%\label{fig:ee18btech11035_G}
%\end{figure}
%
%
%
%\item Verify the gain using spice\\
%\solution Follow the Instructions for SPICE simulation:
%\begin{lstlisting}
%spice/README.md
%\end{lstlisting}Netlist file for simulation:
%\begin{lstlisting}
%spice/ee18btech11035_spice1.net
%\end{lstlisting}
%
%\begin{figure}[!h]
%  \includegraphics[width=\columnwidth]{./figs/ee18btech11035_spice1.eps}
%  \caption{Spice Simulation of Open-loop Transfer Function}
%  \label{fig:ee18btech11035_spice1}
%\end{figure}
%
%
%Python code for above plot:
%\begin{lstlisting}
%codes/ee18btech11035_spice1.py
%\end{lstlisting}
%
%\item Verification of step response of open-loop transfer function through python\\
%\solution 
%\begin{figure}[!h]
%  \includegraphics[width=\columnwidth]{./figs/ee18btech11035_python1.eps}
%  \caption{Python verification of Open-loop Transfer Function}
%  \label{fig:ee18btech11035_pv1}
%\end{figure}
%
%Python code for above verification is 
%\begin{lstlisting}
%codes/ee18btech11035_pythonverify1.py
%\end{lstlisting}
%

\item Given that $H = 0.01$, find $T(s)$.\\
\solution From \eqref{eq:ee18btech11035_G},
\begin{align}
    T\brak{s}&=\frac{G\brak{s}}{1+G\brak{s}H\brak{s}}
%\end{align}
%\begin{align}
%    T&=\frac{\frac{G_{0}}{1+A_{0}H\brak{s}}}{1+\frac{s}{20\pi\brak{1+G_{0}H\brak{s}}}}\\
\\
   &=\frac{99.90}{1+\frac{s}{2\pi 10010}}
\label{eq:ee18btech11035_T}
\end{align}
%
The block diagram is shown in Fig. \ref{fig:ee18btech11035_block}.
%

Block diagram representation of the amplifier
\begin{figure}[!ht]
    \begin{center}
		\resizebox{\columnwidth}{!}{\input{./figs/ee18btech11035_block.tex}}
	\end{center}
\caption{}
\label{fig:ee18btech11035_block}
\end{figure}

\item Find the low frequency gain $T(0)$.\\ 
\solution From \eqref{eq:ee18btech11035_T}

\begin{align}
    T\brak{0}&= 99.900
\end{align}

\item Find the 3-dB frequency of the closed loop amplifier.\\
\solution From \eqref{eq:ee18btech11035_T}
\begin{align}
   f_{3dB} = 10.01kHz
\end{align}

\item Find the unity gain frequency of the closed loop amplifier\\
\solution 
%Unity-gain frequency of the closed loop amplifier is obtained as follows
\begin{align}
    \abs{T\brak{\j\omega_1}}&=1\\
\implies     
{99.90}&=\abs{1+\frac{\j\omega}{2\pi 10010}}
%\frac{G_{0}}{1+G_{0}H\brak{s}}&=\abs{1+\frac{\j\omega}{20\pi\brak{1+G_{0}H\brak{s}}}}\\
%    99.900&=\abs{1+\frac{\j\omega}{62862.8}}\\
\\
\text{or, }    f_1 &= 999.94kHz
\end{align}
upon substitution from \eqref{eq:ee18btech11035_T} and some algebra.

\item By what factor does the pole shift?\\
\solution From \eqref{eq:ee18btech11035_G} and \eqref{eq:ee18btech11035_T}, the ratio of the poles is
\begin{align}
\frac{2\pi \times 10010}{2\pi \times 10} = 1001
\end{align}
%
\item Tabulate the DC Gain, Bandwidth and Gain bandwidth product for $G(s)$ and $T(s)$.
\\
\solution  See Table \ref{table:ee18btech11035_table2}
%Observing the fig:\eqref{fig:ee18btech11035_bode1} and fig:\eqref{fig:ee18btech11035_bode2} to get DC Gain and Bandwidth
\begin{table}[!ht]
\centering
\input{./tables/ee18btech11035_table2.tex}
\caption{}
\label{table:ee18btech11035_table2}
\end{table}

$\therefore$, by using feedback we can get desired Gain of an amplifier while maintaining constant Gain Bandwidth product(for a first-order op-amp).


\item Design the circuit for $H$.
\\
\solution See Fig. \ref{fig:ee18btech11035_feedback}.
For 
\begin{align}
R_{1} &= 10\ohm
\\
R_{f} &= 990\ohm, 
\\
  H &=   \frac{V_{f}}{V_{out}}=\frac{R_{1}}{R_{1}+R_{f}}
\\
&=0.01
\end{align}


\begin{figure}[!ht]
    \begin{center}
		\resizebox{\columnwidth}{!}{\input{./figs/ee18btech11035_feedback.tex}}
	\end{center}
\caption{}
\label{fig:ee18btech11035_feedback}
\end{figure}

\item Design the closed loop circuit for $T(s)$.
\\
\solution See Fig. \ref{fig:ee18btech11035_circuit}.  Table \ref{table:ee18btech11035_table1}
lists the various parameters.
%
\begin{figure}[!ht]
    \begin{center}
		\resizebox{\columnwidth}{!}{\input{./figs/ee18btech11035_circuit.tex}}
	\end{center}
\caption{}
\label{fig:ee18btech11035_circuit}
\end{figure}


\begin{table}[!ht]
\centering
\input{./tables/ee18btech11035_table1.tex}
\caption{}
\label{table:ee18btech11035_table1}
\end{table}


%\item Draw the Bode plots of closed-loop circuit\\
%\solution
%\begin{figure}[!h]
%  \includegraphics[width=\columnwidth]{./figs/ee18btech11035_bode2.eps}
%  \caption{Bode plots of Closed-loop Transfer Function}
%  \label{fig:ee18btech11035_bode2}
%\end{figure}
%
%Python code for above plot is
%\begin{lstlisting}
%codes/ee18btech11035_bode2.py
%\end{lstlisting}
%

\numberwithin{figure}{enumi}
\item Verify the gain of closed loop Circuit using spice\\
\solution Follow the Instructions for SPICE simulation:
\begin{lstlisting}
spice/README.md
\end{lstlisting}
Netlist file for simulation:
\begin{lstlisting}
spice/ee18btech11035_spice2.net
\end{lstlisting}

\renewcommand{\thefigure}{\theenumi.\arabic{figure}}
\begin{figure}[!h]
  \includegraphics[width=\columnwidth]{./figs/ee18btech11035_spice2.eps}
  \caption{Spice simulation of Closed-loop Transfer Function}
  \label{fig:ee18btech11035_spice2}
\end{figure}


The following python code plots the spice output in Fig.   \ref{fig:ee18btech11035_spice2}.
%
\begin{lstlisting}
codes/ee18btech11035_spice2.py
\end{lstlisting}

%\item Verification of step response of open-loop transfer function through python\\
%\solution 

The following  code generates Fig.   \ref{fig:ee18btech11035_pv2}.
%
\begin{lstlisting}
codes/ee18btech11035_pythonverify2.py
\end{lstlisting}
%
\begin{figure}[!h]
  \includegraphics[width=\columnwidth]{./figs/ee18btech11035_python2.eps}
  \caption{Python verification of closed-loop Transfer Function}
  \label{fig:ee18btech11035_pv2}
\end{figure}

\renewcommand{\thefigure}{\theenumi}






\end{enumerate}
